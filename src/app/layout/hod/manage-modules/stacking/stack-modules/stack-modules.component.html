<div class="p-grid mb-5" [@routerTransition]>
    <div class="p-col-6">

        <form #f="ngForm" (change)="onChanges($event)">
            <p-panel header="Modules">

                <!-- MODULE -->
                <div class="p-grid">
                    <div class="p-col-2">
                        <label for="module">
                            Module
                        </label>
                    </div>
                    <div class="p-col-10">
                        <p-dropdown [options]="modules" optionLabel="label" dataKey="id" [(ngModel)]="selectedModule"
                            name="module" #module="ngModel" placeholder="Select a Module" [showClear]="true"
                            [filter]="true" appendTo="body" (onChange)="onModuleSelected($event)" required>
                        </p-dropdown>
                    </div>
                </div>

                <!-- MODULE TO STACK -->
                <div class="p-grid">
                    <div class="p-col-2">
                        <label for="module">
                            Module To Stack
                        </label>
                    </div>
                    <div class="p-col-10">
                        <p-dropdown [options]="unstackedModules" optionLabel="label" dataKey="id"
                            [(ngModel)]="selectedModuleToStack" name="moduleToStack" #moduleToStack="ngModel"
                            placeholder="Select a Module To Stack" [showClear]="true" [filter]="true" appendTo="body"
                            required>
                        </p-dropdown>
                    </div>
                </div>

                <p-footer>
                    <div class="p-grid" *ngIf="!isSubmitting; else spinner">
                        <div class="p-col">
                            <button type="button" pButton label="Add To Stack" icon="pi pi-plus"
                                class="ui-button-success mr-2" (click)="onAddModuleToStack($event)"
                                [disabled]="f.untouched||(f.touched&&f.invalid)"></button>
                            <button type="button" pButton label="Reset" icon="pi pi-refresh"
                                class="ui-button-secondary float-right" (click)="onReset($event)"></button>
                        </div>
                    </div>
                    <div class="p-grid">
                        <div class="p-col">
                            <ng-template #spinner>
                                <p-progressSpinner [style]="{width: '50px', height: '50px'}" strokeWidth="6"
                                    fill="#EEEEEE" animationDuration=".5s"></p-progressSpinner>
                            </ng-template>
                        </div>
                    </div>
                </p-footer>

            </p-panel>
        </form>
    </div>
    <div class="p-col-6">
        <p-table [value]="stackedModules">
            <ng-template pTemplate="caption">
                <div>
                    Stacked With
                </div>
            </ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th colspan="6">
                        Module
                    </th>
                    <th colspan="4">
                        Students Enrolled
                    </th>
                    <th colspan="2">

                    </th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-stackedModule>
                <tr>
                    <td colspan="6">
                        {{stackedModule?.label }}
                    </td>
                    <td colspan="4">
                        {{stackedModule?.studentsEnrolled}}
                    </td>

                    <td colspan="2">
                        <div class="p-grid">
                            <div class="p-col">
                                <div class="box">
                                    <button type="button" label="Remove" pButton icon="pi pi-times"
                                        class="ui-button-danger"
                                        (click)="onRemoveStackedModule($event, module)"></button>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="12">
                        Not stacked with any subjects
                    </td>
                </tr>
            </ng-template>

        </p-table>
    </div>
</div>