<app-page-header [breadcrumbs]="breadcrumbs"></app-page-header>
<div class="p-grid" [@routerTransition]>
    <div class="p-col">
        <form #f="ngForm" (ngSubmit)="onSubmit()">
            <p-panel header="Edit Supervision Activity">

                <!-- USER -->
                <div class="p-grid" *ngIf="activityModel?.userId">
                    <div class="p-col-2">User ID</div>
                    <div class="p-col-6">
                        <input type="text" pInputText [(ngModel)]="activityModel.userId"
                            [ngModelOptions]="{standalone: true}" [disabled]="true">
                    </div>
                    <div class="p-col-4">

                    </div>
                </div>

                <!-- DUTY -->
                <div class="p-grid" *ngIf="activityModel?.dutyId">
                    <div class="p-col-2">Duty ID</div>
                    <div class="p-col-6">
                        <input type="text" pInputText [(ngModel)]="activityModel.dutyId"
                            [ngModelOptions]="{standalone: true}" [disabled]="true">
                    </div>
                    <div class="p-col-4">

                    </div>
                </div>

                <!-- ROLE -->
                <div class="p-grid">
                    <div class="p-col-2">Supervision Role</div>
                    <div class="p-col-6">
                        <p-dropdown [options]="supervisionRoles" optionLabel="label" dataKey="value"
                            placeholder="Supervision Role" appendTo="body" showClear="true" [filter]="true"
                            filterBy="value" [(ngModel)]="selectedSupervisionRole" name="supervisionRole"
                            #supervisionRole="ngModel" required>
                        </p-dropdown>
                    </div>
                    <div class="p-col-4">
                        <p-message severity="error" text="Supervision Role is required"
                            *ngIf="(supervisionRole.touched || supervisionRole.dirty) && supervisionRole.hasError('required')">
                        </p-message>
                    </div>
                </div>

                <!-- SPLIT -->
                <div class="p-grid" *ngIf="selectedSupervisionRole.value === 'Co-Supervisor'">
                    <div class="p-col-2">Split</div>
                    <div class="p-col-6">
                        <p-dropdown [options]="splits" optionLabel="label" placeholder="Split" appendTo="body"
                            showClear="true" [filter]="true" filterBy="value" [(ngModel)]="selectedSplit" name="split"
                            #split="ngModel" required>
                        </p-dropdown>
                    </div>
                    <div class="p-col-4">
                        <p-message severity="error" text="Split field is required"
                            *ngIf="(split.touched || split.dirty) && split.hasError('required')">
                        </p-message>
                    </div>
                </div>

                <!-- STUDENT -->
                <div class="p-grid">
                    <div class="p-col-2">Student</div>
                    <div class="p-col-6">
                        <p-dropdown [options]="students" optionLabel="studentId" dataKey="studentId"
                            placeholder="Select Student" appendTo="body" showClear="true" [filter]="true"
                            filterBy="studentId" [(ngModel)]="selectedStudent" name="student" #student="ngModel"
                            required>
                        </p-dropdown>
                    </div>
                    <div class="p-col-4">
                        <p-message severity="error" text="Student is required"
                            *ngIf="(student.touched || student.dirty) && student.hasError('required')">
                        </p-message>
                    </div>
                </div>

                <p-footer>
                    <div class="p-grid" *ngIf="!isSubmitting; else spinner">
                        <div class="p-col-10 p-col-align-left">
                            <button pButton type="button" label="Back" icon="pi pi-arrow-left" (click)="onBack($event)"
                                class="ui-button-danger mr-2"></button>
                            <button pButton label="Save" icon="pi pi-plus"
                                [disabled]="f.pristine || (f.dirty && f.invalid)" class=""></button>
                        </div>
                        <div class="p-col-2 p-col-align-right">
                            <button pButton type="button" label="Reset" icon="pi pi-refresh" (click)="onReset($event)"
                                class="ui-button-secondary"></button>
                        </div>
                    </div>

                    <div class="p-grid">
                        <div class="p-col">
                            <ng-template #spinner>
                                <p-progressSpinner [style]="{width: '50px', height: '50px'}" strokeWidth="6"
                                    fill="#EEEEEE" animationDuration=".5s"></p-progressSpinner>
                            </ng-template>
                        </div>
                    </div>
                </p-footer>
            </p-panel>
        </form>
    </div>
</div>